---
import BaseLayout from '../layouts/BaseLayout.astro';
import fs from 'node:fs';
import path from 'node:path';
import { parse } from 'yaml';
import index from '../../entities/index.json';

const { slug } = Astro.params;
const entity = Object.values(index).find(e => e.slug === slug);
if (!entity) throw new Error(`Entity not found: ${slug}`);

const mdPath = path.resolve('./', entity.path);
const mdRaw = fs.readFileSync(mdPath, 'utf-8');
const [, yamlBlock, markdown] = mdRaw.match(/---\n([\s\S]*?)---\n([\s\S]*)/) || [];
const metadata = parse(yamlBlock || '');
---

<BaseLayout title={entity.name}>
  <h2>{entity.name}</h2>
  <p><strong>Typ:</strong> {entity.type}</p>
  <pre>{markdown}</pre>
</BaseLayout>
